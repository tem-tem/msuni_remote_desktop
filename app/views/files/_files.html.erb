<div class="d-flex justify-content-end mt-3"
    role="group"
    aria-label="Videos navigation">
  <button class="btn btn-sm btn-outline-primary dropdown-toggle"
          id="dropdownMenu2"
          data-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="false">
    Фильтр
  </button>

  <div class="dropdown-menu dropdown-menu-right"
      aria-labelledby="dropdownMenu2"
      style="box-shadow: 0 10px 50px rgba(0,0,0,0.2)">
    <h6 class="dropdown-header border-bottom mb-2">Выберите категорию</h6>
    <% ftps = files.map{|f| f.filetype } %>
    <% ftps.uniq.each do |f| %>
      <div class="dropdown-item filetype-filter" value="<%= f %>">
        <%= f %>
      </div>
    <% end %>
    <div class="dropdown-divider"></div>
    <div class="dropdown-item filetype-filter" value="file-with-filetype">
      Убрать фильтр
    </div>
  </div>
</div>


<% content_for :page_scripts do %>
  <script>
    $(".filetype-filter").on("click", function(e) {
      t = $(e.target).attr("value");
      if (t == 'file-with-filetype'){
        $("#dropdownMenu2").text('Фильтр');
      } else {
        $("#dropdownMenu2").text('Фильтр: '+ t);
      };
      $('.file-with-filetype').hide();
      $( '.' +  t).show();
    });
  </script>
<% end %>


<% files.each do |file| %>
    <div class="file-client presentation-client file-with-filetype <%= file.filetype %>"
      style="block">
    
      <div class="client-lecture-title">
        <%= file.name %>
      </div>
    
      <div class="d-flex justify-content-between align-items-start"
          style="padding: 0 0 0.5em 2em;">
        <div class="file-category">
          <%= file.filetype %>
        </div>
        <div class="d-flex justify-content-end">
          <% if file.file? %>
            <%= link_to file.file.url, class: 'book-botton blue-shadow' do %>
              <%= octicon "arrow-down",
                width: 20,
                height: 20,
                class: "button-icon",
                "aria-label": "Скачать" %>
              <small class="mr-1">Скачать</small>
            <% end %>
          <% end %>
          
          <% if file.link? %>
            <%= link_to file.link,
                target: '_blank',
                class: 'book-botton blue-shadow' do %>
              <%= octicon "link-external",
                width: 20,
                height: 20,
                class: "button-icon",
                "aria-label": "Открыть" %>
            <% end %>
          <% end %>
        </div>
      </div>
    
    </div>
<% end %>